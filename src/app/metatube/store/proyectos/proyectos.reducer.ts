import { createReducer, on } from "@ngrx/store";
import { Proyecto, Channel } from "src/api/index";
import * as proyectosActions  from "./proyectos.actions";

export interface ProyectosState{
  cargando : boolean,
  error : boolean,
  proyectos : Proyecto[],
  proyecto_seleccionado : Proyecto,
  canal_seleccionado : Channel,
  grafica_mejor_dia : any
}

export const initialState: ProyectosState = {
  cargando: false,
  error: false,
  proyectos: [],
  proyecto_seleccionado: {
    id: -1,
    nombre: 'no seleccionado',
    url: '/',
    canal: '',
    usuario: 0,
  },
  canal_seleccionado: {
    id: '',
    title: '',
    description: '',
    publishedAt: '',
    defaultLanguage: '',
    country: '',
    thumbnail_default_url: '',
    thumbnail_high_url: '',
    viewCount: 0,
    subscriberCount: 0,
    hiddenSubscriberCount: true,
    videoCount: 0,
    topics: [],
    topicCategories: [],
    keywords: [],
    playlistId: '',
  },
  grafica_mejor_dia : [
    [0, 10, 0.023712469130517912],
    [0, 12, 0.06264997757975915],
    [0, 13, 0.41836047174561136],
    [0, 15, 0.19142597044398094],
    [0, 17, 0.7303433790140064],
    [0, 18, 0.4076902103095454],
    [0, 19, 0.11945167980253966],
    [0, 20, 0.2597008699646189],
    [0, 22, 0.050172782636537],
    [1, 10, 0.024071534945427086],
    [1, 12, 0.0127718338257842],
    [1, 14, 0.12891499246421512],
    [1, 17, 0.6475117054422206],
    [1, 18, 0.5115367377876363],
    [1, 19, 0.5427609550790741],
    [1, 22, 0.08430699279769253],
    [2, 9, 0.039404398507239514],
    [2, 12, 0.17650953680825612],
    [2, 16, 0.2796396774498624],
    [2, 17, 0.5437326911742992],
    [2, 18, 0.6598452914913139],
    [2, 20, 0.26093882623523157],
    [2, 22, 0.29609096675974705],
    [2, 23, 0.047888911045351715],
    [3, 9, 0.01666874178460217],
    [3, 11, 0.0015766988954609203],
    [3, 12, 0.07052314749664775],
    [3, 13, 0.10033365255680363],
    [3, 14, 0.17952300814954963],
    [3, 15, 0.19818899478887939],
    [3, 16, 0.5089494507688181],
    [3, 17, 0.5880569555413062],
    [3, 18, 0.49767149046284304],
    [3, 19, 0.22232337170531374],
    [3, 20, 0.07089525360720307],
    [3, 21, 0.07166099913887515],
    [3, 22, 0.03263995378778172],
    [4, 3, 0.07720844270095223],
    [4, 10, 0.03313122464791468],
    [4, 11, 0.014772437772734187],
    [4, 15, 0.11807475618718791],
    [4, 16, 0.21570622846028273],
    [4, 17, 0.5765005915932337],
    [4, 18, 0.09242536718225698],
    [4, 19, 0.3332546674405818],
    [4, 20, 0.2087274249230403],
    [4, 21, 0.6483621097821229],
    [4, 22, 0.12789648577214618],
    [5, 15, 0.5010160618608571],
    [5, 16, 0.21719157429700525],
    [5, 17, 0.817662276719081],
    [5, 18, 0.09093595148784239],
    [5, 19, 0.10490696179284005],
    [5, 20, 0.025729135553389633],
    [5, 21, 0.01941441508462215],
    [5, 23, 0.11368993450340617],
    [6, 12, 0.35784280934653],
    [6, 13, 0.007623234307533728],
    [6, 14, 0.15497371248725803],
    [6, 15, 0.09821942647350888],
    [6, 16, 0.07213256216584095],
    [6, 17, 0.07508323816946245],
    [6, 18, 0.8303351379106746],
    [6, 19, 0.3112151188965102],
    [6, 20, 0.057707228069393435],
    [6, 21, 0.14711639705809765],
    [6, 22, 0.07053410308360056],
    [6, 23, 0.1054807754458657],
  ]
};

export const proyectosReducer = createReducer(
  initialState,
  on(proyectosActions.cargarProyectos, (state) => ({
    ...state,
    cargando: true,
  })),
  on(proyectosActions.cargarProyectosSuccess, (state, { proyectos }) => {
    return { ...state, cargando: false, proyectos };
  }),
  on(proyectosActions.cargarProyectosFailure, (state) => ({
    ...state,
    error: true,
  })),
  on(proyectosActions.seleccionaProyecto, (state, { proyecto }) => ({
    ...state,
    proyecto_seleccionado: proyecto,
  })),
  on(proyectosActions.crearProyecto, (state, { proyecto }) => ({ ...state })),
  on(proyectosActions.crearProyectoSuccess, (state, { proyecto }) => ({
    ...state,
  })),
  on(proyectosActions.crearProyectoFailure, (state, { error }) => ({
    ...state,
  })),
  on(proyectosActions.cargarCanalSuccess, (state, {canal})=>({...state, canal_seleccionado: canal}))
);
